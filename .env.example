# ===========================================
# AI 서비스 API 키 설정
# ===========================================

# 🎯 VModel AI API Token (1순위 - 얼굴교체 전용)
# Get your token from: https://vmodel.ai (API section after login)
# Cost: $0.02 per use | Processing time: ~30 seconds
VMODEL_API_TOKEN=your_vmodel_api_token_here

# 🔥 Firebase OpenAI Proxy (2순위 - 9분 타임아웃)
# Firebase Functions URL은 코드에 하드코딩되어 있음
# https://us-central1-hgfaceswap-functions.cloudfunctions.net/openaiProxy
# 별도 환경변수 불필요 (Firebase Functions에서 OpenAI API 키 관리)

# 🔍 Google Gemini API Key (3순위 폴백 + 의상변경 + 비디오 생성)
# Get your API key from: https://aistudio.google.com
# ⚠️ 중요: 비디오 생성 기능(Veo 2/3.1)에도 사용됩니다
GEMINI_API_KEY=your_gemini_api_key_here

# ===========================================
# 이미지 호스팅 서비스 (VModel AI용 HTTP URL 생성)
# ===========================================

# 🥇 Option 1: Cloudinary (추천)
# Get from: https://cloudinary.com 
# Free tier: 25GB storage, 25GB bandwidth/month
CLOUDINARY_CLOUD_NAME=your_cloudinary_cloud_name
CLOUDINARY_API_KEY=your_cloudinary_api_key
CLOUDINARY_API_SECRET=your_cloudinary_api_secret

# 🥈 Option 2: Imgur (대안)
# Get from: https://api.imgur.com/oauth2/addclient
# Free: Unlimited uploads with API rate limits
IMGUR_CLIENT_ID=your_imgur_client_id

# ===========================================
# 기존 API 키들 (필요시 유지)
# ===========================================

# ⚠️ Kling AI API Keys (영상 변환용 - DEPRECATED)
# ❌ 더 이상 사용하지 않음 - Gemini Video API(Veo 2/3.1)로 교체됨
# 아래 키들은 레거시 코드 호환성을 위해 남겨둠
# KLING_ACCESS_KEY=your_kling_access_key_here
# KLING_SECRET_KEY=your_kling_secret_key_here

# OpenAI API Key (직접 사용 - 현재는 Firebase를 통해 사용)
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-your-actual-openai-api-key-here

# ===========================================
# 사용자 관리 서비스
# ===========================================

# Bullnabi 서비스 (사용자 크레딧 관리)
# 내부 토큰 관리 시스템
BULLNABI_TOKEN=your_bullnabi_token_here

# ===========================================
# 서비스 우선순위 및 특징
# ===========================================

# 📋 얼굴 변환 처리 순서:
# 1순위: VModel AI (참고이미지 → 원본이미지 교체)
#        ✅ 비용: $0.02/회 | ✅ 속도: ~30초 | ✅ 품질: 높음 | ✅ 법적 안전
#
# 2순위: Firebase OpenAI (VModel 실패시 텍스트 기반)
#        ✅ 타임아웃: 9분 | ✅ 메모리: 2GB | ✅ gpt-image-1 API
#
# 3순위: Gemini (최종 폴백)
#        ✅ 속도: ~14초 | ✅ 무료 | ✅ 텍스트 프롬프트 지원
#
# 공통: Gemini 의상변경 (모든 경우에 적용)

# 📋 비디오 생성 처리 (NEW - Gemini Video API):
# 🎬 Veo 2.0 (이미지 1개)
#        ✅ 비용: 1 크레딧 | ✅ 영상: 5초 | ✅ 모델: veo-2.0-generate-001
#
# 🎬 Veo 3.1 (이미지 2개 - 전환 영상)
#        ✅ 비용: 3 크레딧 | ✅ 영상: 10초 | ✅ 모델: veo-3.1-generate-preview
#        ✅ 특징: last_frame 기능으로 자연스러운 장면 전환

# 📋 이미지 호스팅 처리 순서:
# 1순위: Cloudinary (안정성, 기능)
# 2순위: Imgur (간단함)  
# 3순위: Temp URL (개발용만)

# ===========================================
# 개발 환경 설정
# ===========================================

# Node.js 버전
# 권장: Node.js 20+
# .nvmrc 파일 참조

# 빌드 환경
NODE_ENV=development

# ===========================================
# 배포시 주의사항
# ===========================================

# ✅ Netlify 환경변수 설정 체크리스트:
# 1. ⚠️ GEMINI_API_KEY - 필수! (얼굴변환 폴백 + 의상변경 + 비디오 생성)
# 2. VMODEL_API_TOKEN - 얼굴 변환용
# 3. CLOUDINARY_* (3개) - 이미지 호스팅용
# 4. IMGUR_CLIENT_ID - 이미지 호스팅 대안
# 5. BULLNABI_TOKEN - 크레딧 관리
# 6. OPENAI_API_KEY - (선택) Firebase 대신 직접 사용시

# 📝 Netlify Functions 설정:
# - netlify/functions/gemini-video-proxy.js 배포 확인
# - Functions 타임아웃: 최소 300초 (5분) 설정
# - Node.js 버전: 20.x 이상

# 🔧 Package.json 의존성 확인:
# - @google/generative-ai: ^0.21.0 이상
# - React 컴포넌트에서 geminiVideoService import 정상 작동 확인

# ===========================================
# 비용 예상
# ===========================================

# 💰 얼굴 변환:
# - VModel AI: $0.02 per image transformation
# - Cloudinary: Free tier sufficient for moderate usage
# - Imgur: Free with rate limits
# - Firebase: Pay-per-use (OpenAI API 비용)
# - Gemini (폴백): Free tier available

# 💰 비디오 생성 (NEW):
# - Gemini Veo 2 (1장): 1 크레딧 / 5초 영상
# - Gemini Veo 3.1 (2장): 3 크레딧 / 10초 전환 영상
# - ⚠️ Gemini API 할당량: 무료 티어 제한 확인 필요
#   (https://ai.google.dev/pricing 참조)

# ===========================================
# 트러블슈팅
# ===========================================

# ❌ "Gemini API key not found" 에러:
# → Netlify 환경변수에 GEMINI_API_KEY 설정 확인
# → .env 파일이 .gitignore에 포함되어 있는지 확인

# ❌ "Video generation timeout" 에러:
# → Netlify Functions 타임아웃 설정 확인 (최소 300초)
# → netlify.toml에 timeout 설정 추가

# ❌ "Module not found: @google/generative-ai" 에러:
# → npm install @google/generative-ai
# → package.json에 의존성 추가 확인

# ❌ iPhone에서 비디오 다운로드 안됨:
# → CORS 설정 확인 (Netlify Functions 헤더)
# → Share API 폴백 → Blob 다운로드 → 새창 열기 순서로 작동

# ===========================================
# 마이그레이션 가이드 (Kling → Gemini)
# ===========================================

# 1. 의존성 설치:
#    npm install @google/generative-ai

# 2. 환경변수 설정:
#    GEMINI_API_KEY를 Netlify에 추가

# 3. 파일 교체:
#    - components/VideoSwap.tsx (새 버전)
#    - services/geminiVideoService.ts (NEW)
#    - netlify/functions/gemini-video-proxy.js (NEW)

# 4. 기존 Kling 관련 코드 제거:
#    - services/klingService.ts (선택적 제거)
#    - KLING_ACCESS_KEY, KLING_SECRET_KEY (더 이상 불필요)

# 5. 테스트:
#    - 이미지 1개 → 5초 영상 (1 크레딧)
#    - 이미지 2개 → 10초 전환 영상 (3 크레딧)
#    - iPhone Safari에서 다운로드 테스트

# 6. 배포 후 확인:
#    ✅ Netlify Functions 로그에서 "Gemini Video 생성" 확인
#    ✅ 비디오 URL이 정상적으로 반환되는지 확인
#    ✅ 크레딧 차감이 정확한지 확인

# ===========================================
# 성능 최적화 팁
# ===========================================

# 📊 이미지 크기 최적화:
# - 권장: 1080x1920 (세로 영상) 또는 1920x1080 (가로 영상)
# - 최대: 4096x4096
# - 파일 크기: 5MB 이하 권장

# ⚡ API 호출 최적화:
# - 재시도 로직: 3회 (지수 백오프)
# - 타임아웃: 5분
# - 동시 요청 제한: 사용자당 1개

# 💾 캐싱 전략:
# - 생성된 비디오 URL을 로컬 스토리지에 임시 저장
# - preservedVideoUrl prop으로 페이지 새로고침 시 복원

# ===========================================
# 보안 고려사항
# ===========================================

# 🔒 API 키 보안:
# - 절대 프론트엔드 코드에 하드코딩 금지
# - Netlify Functions를 통해서만 API 호출
# - Environment Variables는 Netlify UI에서만 설정

# 🔒 CORS 설정:
# - Netlify Functions에서 적절한 CORS 헤더 반환
# - 특정 도메인만 허용하려면 Access-Control-Allow-Origin 수정

# 🔒 Rate Limiting:
# - Gemini API 할당량 모니터링
# - 사용자당 일일 생성 횟수 제한 고려

# ===========================================
# 모니터링 및 로깅
# ===========================================

# 📊 중요 로그 포인트:
# - 🎬 Gemini Video 생성 시작
# - ✅ 영상 생성 완료
# - ❌ 영상 생성 실패
# - 💳 크레딧 차감
# - 📥 iPhone 다운로드 시작/완료

# 📊 Netlify Functions 로그 확인:
# - Netlify Dashboard → Functions → gemini-video-proxy
# - 실시간 로그 스트리밍으로 디버깅

# ===========================================
# 라이선스 및 크레딧
# ===========================================

# Gemini Video API (Veo 2/3.1): Google Generative AI
# License: https://ai.google.dev/gemini-api/terms
# Documentation: https://ai.google.dev/gemini-api/docs/video-generation

# ===========================================
# 버전 정보
# ===========================================

# Version: 2.0.0 (Gemini Video Integration)
# Last Updated: 2025-10-16
# Migration: Kling AI → Gemini Video API (Veo 2/3.1)
